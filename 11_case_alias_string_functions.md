# SQL: CASE, –ê–ª–∏–∞—Å—ã, –°—Ç—Ä–æ–∫–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ - –ö—Ä–∞—Ç–∫–∏–π —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫

## üîÄ –û–ø–µ—Ä–∞—Ç–æ—Ä CASE

| –•–æ—á—É —Å–¥–µ–ª–∞—Ç—å... | –ò—Å–ø–æ–ª—å–∑—É–π | –ü—Ä–∏–º–µ—Ä |
| --------------- | --------- | ------ |
| –ü—Ä–æ—Å—Ç–æ–µ —É—Å–ª–æ–≤–∏–µ (–µ—Å–ª–∏-—Ç–æ-–∏–Ω–∞—á–µ) | `CASE WHEN ... THEN ... ELSE ... END` | `CASE WHEN age >= 18 THEN '–í–∑—Ä–æ—Å–ª—ã–π' ELSE '–†–µ–±–µ–Ω–æ–∫' END` |
| –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —É—Å–ª–æ–≤–∏—è | `CASE WHEN ... THEN ... WHEN ... THEN ... ELSE ... END` | `CASE WHEN grade >= 90 THEN 'A' WHEN grade >= 80 THEN 'B' ELSE 'C' END` |
| –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ | `CASE column WHEN value1 THEN ... WHEN value2 THEN ... END` | `CASE status WHEN 'active' THEN '–ê–∫—Ç–∏–≤–µ–Ω' WHEN 'blocked' THEN '–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω' END` |

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ CASE:
```sql
CASE 
    WHEN —É—Å–ª–æ–≤–∏–µ1 THEN —Ä–µ–∑—É–ª—å—Ç–∞—Ç1
    WHEN —É—Å–ª–æ–≤–∏–µ2 THEN —Ä–µ–∑—É–ª—å—Ç–∞—Ç2
    ELSE —Ä–µ–∑—É–ª—å—Ç–∞—Ç_–ø–æ_—É–º–æ–ª—á–∞–Ω–∏—é
END AS –Ω–æ–≤–æ–µ_–∏–º—è_—Å—Ç–æ–ª–±—Ü–∞
```

### –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–º–µ—Ä—ã CASE:

| –ó–∞–¥–∞—á–∞ | –†–µ—à–µ–Ω–∏–µ |
| ------ | ------- |
| –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø–æ –≤–æ–∑—Ä–∞—Å—Ç—É | `CASE WHEN age < 18 THEN '–ù–µ—Å–æ–≤–µ—Ä—à–µ–Ω–Ω–æ–ª–µ—Ç–Ω–∏–π' WHEN age < 65 THEN '–¢—Ä—É–¥–æ—Å–ø–æ—Å–æ–±–Ω—ã–π' ELSE '–ü–µ–Ω—Å–∏–æ–Ω–µ—Ä' END` |
| –°—Ç–∞—Ç—É—Å –∑–∞–∫–∞–∑–∞ | `CASE status WHEN 1 THEN '–ù–æ–≤—ã–π' WHEN 2 THEN '–í —Ä–∞–±–æ—Ç–µ' WHEN 3 THEN '–í—ã–ø–æ–ª–Ω–µ–Ω' ELSE '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ' END` |
| –†–∞–∑–º–µ—Ä —Å–∫–∏–¥–∫–∏ | `CASE WHEN total > 1000 THEN 0.1 WHEN total > 500 THEN 0.05 ELSE 0 END` |

---

## üè∑Ô∏è –ê–ª–∏–∞—Å—ã (–ü—Å–µ–≤–¥–æ–Ω–∏–º—ã)

| –ß—Ç–æ –Ω–∞–∑—ã–≤–∞—é | –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å | –ü—Ä–∏–º–µ—Ä |
| ----------- | --------------- | ------ |
| **–°—Ç–æ–ª–±–µ—Ü** | `column AS alias` –∏–ª–∏ `column alias` | `first_name AS –∏–º—è`, `COUNT(*) total` |
| **–¢–∞–±–ª–∏—Ü—É** | `table AS alias` –∏–ª–∏ `table alias` | `users AS u`, `orders o` |
| **–†–µ–∑—É–ª—å—Ç–∞—Ç —Ñ—É–Ω–∫—Ü–∏–∏** | `FUNCTION() AS alias` | `SUM(price) AS –æ–±—â–∞—è_—Å—É–º–º–∞` |
| **CASE –≤—ã—Ä–∞–∂–µ–Ω–∏–µ** | `CASE ... END AS alias` | `CASE ... END AS –∫–∞—Ç–µ–≥–æ—Ä–∏—è` |

### –ó–∞—á–µ–º –Ω—É–∂–Ω—ã –∞–ª–∏–∞—Å—ã?

| –ü—Ä–æ–±–ª–µ–º–∞ | –†–µ—à–µ–Ω–∏–µ —Å –∞–ª–∏–∞—Å–æ–º |
| -------- | ----------------- |
| –î–ª–∏–Ω–Ω–æ–µ –∏–º—è —Å—Ç–æ–ª–±—Ü–∞ | `customer_first_name AS –∏–º—è` |
| –§—É–Ω–∫—Ü–∏—è –±–µ–∑ –∏–º–µ–Ω–∏ | `COUNT(*) AS –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ` |
| –î—É–±–ª–∏—Ä—É—é—â–∏–µ—Å—è –∏–º–µ–Ω–∞ —Å—Ç–æ–ª–±—Ü–æ–≤ | `u.name AS –∏–º—è_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, c.name AS –Ω–∞–∑–≤–∞–Ω–∏–µ_–∫–æ–º–ø–∞–Ω–∏–∏` |
| –°–ª–æ–∂–Ω–æ–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ | `price * quantity AS —Å—Ç–æ–∏–º–æ—Å—Ç—å` |
| –†—É—Å—Å–∫–∏–µ –Ω–∞–∑–≤–∞–Ω–∏—è –¥–ª—è –æ—Ç—á–µ—Ç–æ–≤ | `status AS —Å—Ç–∞—Ç—É—Å_–∑–∞–∫–∞–∑–∞` |

### –ü—Ä–∞–≤–∏–ª–∞ –∞–ª–∏–∞—Å–æ–≤:
- –ê–ª–∏–∞—Å —Å –ø—Ä–æ–±–µ–ª–∞–º–∏: `AS "–ü–æ–ª–Ω–æ–µ –∏–º—è"` –∏–ª–∏ `AS '–ü–æ–ª–Ω–æ–µ –∏–º—è'`
- –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ ORDER BY: `ORDER BY –∏–º—è`
- –ù–µ–ª—å–∑—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ WHERE (–∏—Å–ø–æ–ª—å–∑—É–π HAVING)

---

## ‚ùì –û–ø–µ—Ä–∞—Ç–æ—Ä IF (MySQL)

| –°–∏–Ω—Ç–∞–∫—Å–∏—Å | –û–ø–∏—Å–∞–Ω–∏–µ | –ü—Ä–∏–º–µ—Ä |
| --------- | -------- | ------ |
| `IF(—É—Å–ª–æ–≤–∏–µ, –∑–Ω–∞—á–µ–Ω–∏–µ_–µ—Å–ª–∏_true, –∑–Ω–∞—á–µ–Ω–∏–µ_–µ—Å–ª–∏_false)` | –ü—Ä–æ—Å—Ç–æ–µ —É—Å–ª–æ–≤–∏–µ | `IF(age >= 18, '–í–∑—Ä–æ—Å–ª—ã–π', '–†–µ–±–µ–Ω–æ–∫')` |
| `IFNULL(–∑–Ω–∞—á–µ–Ω–∏–µ, –∑–∞–º–µ–Ω–∞_–µ—Å–ª–∏_null)` | –ó–∞–º–µ–Ω–∞ NULL | `IFNULL(phone, '–ù–µ —É–∫–∞–∑–∞–Ω')` |
| `NULLIF(–∑–Ω–∞—á–µ–Ω–∏–µ1, –∑–Ω–∞—á–µ–Ω–∏–µ2)` | NULL –µ—Å–ª–∏ –∑–Ω–∞—á–µ–Ω–∏—è —Ä–∞–≤–Ω—ã | `NULLIF(price, 0)` |

### IF vs CASE:

| –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å | –í—ã–±–∏—Ä–∞–π |
| ------------------ | ------- |
| –ü—Ä–æ—Å—Ç–æ–µ —É—Å–ª–æ–≤–∏–µ (–¥–∞/–Ω–µ—Ç) | `IF()` - –∫–æ—Ä–æ—á–µ |
| –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —É—Å–ª–æ–≤–∏—è | `CASE` - —á–∏—Ç–∞–±–µ–ª—å–Ω–µ–µ |
| –°—Ç–∞–Ω–¥–∞—Ä—Ç SQL | `CASE` - —Ä–∞–±–æ—Ç–∞–µ—Ç –≤–µ–∑–¥–µ |
| –¢–æ–ª—å–∫–æ MySQL | `IF()` - —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω–æ –¥–ª—è MySQL |

---

## üõ†Ô∏è –î—Ä—É–≥–∏–µ —Å–ø–æ—Å–æ–±—ã —Å–æ–∑–¥–∞–Ω–∏—è —Å—Ç–æ–ª–±—Ü–æ–≤

| –°–ø–æ—Å–æ–± | –û–ø–∏—Å–∞–Ω–∏–µ | –ü—Ä–∏–º–µ—Ä |
| ------ | -------- | ------ |
| **–ê—Ä–∏—Ñ–º–µ—Ç–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏** | +, -, *, / | `price * quantity AS total` |
| **–§—É–Ω–∫—Ü–∏–∏ –¥–∞—Ç—ã** | –†–∞–±–æ—Ç–∞ —Å –¥–∞—Ç–∞–º–∏ | `YEAR(birth_date) AS –≥–æ–¥_—Ä–æ–∂–¥–µ–Ω–∏—è` |
| **–°—Ç—Ä–æ–∫–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏** | –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–µ–∫—Å—Ç–∞ | `UPPER(name) AS –∏–º—è_–∑–∞–≥–ª–∞–≤–Ω—ã–º–∏` |
| **–£—Å–ª–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏** | COALESCE, ISNULL | `COALESCE(phone, email, '–ù–µ—Ç –∫–æ–Ω—Ç–∞–∫—Ç–∞') AS —Å–≤—è–∑—å` |
| **–ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏** | ROUND, ABS, CEIL | `ROUND(price, 2) AS –æ–∫—Ä—É–≥–ª–µ–Ω–Ω–∞—è_—Ü–µ–Ω–∞` |

### –ü–æ–ª–µ–∑–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Å—Ç–æ–ª–±—Ü–æ–≤:

| –§—É–Ω–∫—Ü–∏—è | –ß—Ç–æ –¥–µ–ª–∞–µ—Ç | –ü—Ä–∏–º–µ—Ä |
| ------- | ---------- | ------ |
| `COALESCE(val1, val2, val3)` | –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø–µ—Ä–≤–æ–µ –Ω–µ-NULL –∑–Ω–∞—á–µ–Ω–∏–µ | `COALESCE(phone, email, '–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö')` |
| `GREATEST(val1, val2, val3)` | –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ | `GREATEST(salary1, salary2, salary3)` |
| `LEAST(val1, val2, val3)` | –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ | `LEAST(price1, price2, price3)` |

---

## üìù –°—Ç—Ä–æ–∫–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

| –•–æ—á—É... | –ò—Å–ø–æ–ª—å–∑—É–π | –ü—Ä–∏–º–µ—Ä |
| ------- | --------- | ------ |
| –°–¥–µ–ª–∞—Ç—å –∑–∞–≥–ª–∞–≤–Ω—ã–º–∏ | `UPPER(string)` | `UPPER('–ø—Ä–∏–≤–µ—Ç')` ‚Üí `'–ü–†–ò–í–ï–¢'` |
| –°–¥–µ–ª–∞—Ç—å —Å—Ç—Ä–æ—á–Ω—ã–º–∏ | `LOWER(string)` | `LOWER('–ü–†–ò–í–ï–¢')` ‚Üí `'–ø—Ä–∏–≤–µ—Ç'` |
| –£–∑–Ω–∞—Ç—å –¥–ª–∏–Ω—É —Å—Ç—Ä–æ–∫–∏ | `LENGTH(string)` –∏–ª–∏ `LEN(string)` | `LENGTH('–ü—Ä–∏–≤–µ—Ç')` ‚Üí `6` |
| –û–±—Ä–µ–∑–∞—Ç—å –ø—Ä–æ–±–µ–ª—ã | `TRIM(string)` | `TRIM(' –ø—Ä–∏–≤–µ—Ç ')` ‚Üí `'–ø—Ä–∏–≤–µ—Ç'` |
| –í–∑—è—Ç—å —á–∞—Å—Ç—å —Å—Ç—Ä–æ–∫–∏ | `SUBSTRING(string, start, length)` | `SUBSTRING('–ü—Ä–∏–≤–µ—Ç', 1, 3)` ‚Üí `'–ü—Ä–∏'` |
| –ó–∞–º–µ–Ω–∏—Ç—å —Ç–µ–∫—Å—Ç | `REPLACE(string, old, new)` | `REPLACE('–ü—Ä–∏–≤–µ—Ç –º–∏—Ä', '–º–∏—Ä', '–≤—Å–µ–º')` ‚Üí `'–ü—Ä–∏–≤–µ—Ç –≤—Å–µ–º'` |
| –ù–∞–π—Ç–∏ –ø–æ–∑–∏—Ü–∏—é | `POSITION(substring IN string)` | `POSITION('–∏–≤' IN '–ü—Ä–∏–≤–µ—Ç')` ‚Üí `3` |

### –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å—Ç—Ä–æ–∫–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:

| –§—É–Ω–∫—Ü–∏—è | –û–ø–∏—Å–∞–Ω–∏–µ | –ü—Ä–∏–º–µ—Ä |
| ------- | -------- | ------ |
| `LEFT(string, length)` | –ü–µ—Ä–≤—ã–µ N —Å–∏–º–≤–æ–ª–æ–≤ | `LEFT('–ü—Ä–∏–≤–µ—Ç', 3)` ‚Üí `'–ü—Ä–∏'` |
| `RIGHT(string, length)` | –ü–æ—Å–ª–µ–¥–Ω–∏–µ N —Å–∏–º–≤–æ–ª–æ–≤ | `RIGHT('–ü—Ä–∏–≤–µ—Ç', 3)` ‚Üí `'–≤–µ—Ç'` |
| `REVERSE(string)` | –ü–µ—Ä–µ–≤–æ—Ä–æ—Ç —Å—Ç—Ä–æ–∫–∏ | `REVERSE('abc')` ‚Üí `'cba'` |
| `REPEAT(string, count)` | –ü–æ–≤—Ç–æ—Ä–µ–Ω–∏–µ —Å—Ç—Ä–æ–∫–∏ | `REPEAT('ha', 3)` ‚Üí `'hahaha'` |
| `LPAD(string, length, pad)` | –î–æ–ø–æ–ª–Ω–µ–Ω–∏–µ —Å–ª–µ–≤–∞ | `LPAD('5', 3, '0')` ‚Üí `'005'` |
| `RPAD(string, length, pad)` | –î–æ–ø–æ–ª–Ω–µ–Ω–∏–µ —Å–ø—Ä–∞–≤–∞ | `RPAD('5', 3, '0')` ‚Üí `'500'` |

---

## üîó –ö–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏—è —Å—Ç—Ä–æ–∫

| –°–£–ë–î | –°–ø–æ—Å–æ–± | –ü—Ä–∏–º–µ—Ä |
| ---- | ------ | ------ |
| **MySQL** | `CONCAT(str1, str2, ...)` | `CONCAT(first_name, ' ', last_name)` |
| **PostgreSQL** | `str1 \|\| str2` –∏–ª–∏ `CONCAT()` | `first_name \|\| ' ' \|\| last_name` |
| **SQL Server** | `str1 + str2` –∏–ª–∏ `CONCAT()` | `first_name + ' ' + last_name` |
| **Oracle** | `str1 \|\| str2` –∏–ª–∏ `CONCAT()` | `first_name \|\| ' ' \|\| last_name` |

### –ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è –∫–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏—è:

| –ó–∞–¥–∞—á–∞ | –†–µ—à–µ–Ω–∏–µ |
| ------ | ------- |
| –û–±—ä–µ–¥–∏–Ω–∏—Ç—å —Å —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª–µ–º | `CONCAT_WS(separator, str1, str2, str3)` |
| –ü–æ–ª–Ω–æ–µ –∏–º—è | `CONCAT(last_name, ', ', first_name)` |
| –ê–¥—Ä–µ—Å | `CONCAT_WS(', ', city, street, house)` |
| Email –∏–∑ —á–∞—Å—Ç–µ–π | `CONCAT(username, '@', domain)` |

### –û—Å—Ç–æ—Ä–æ–∂–Ω–æ —Å NULL:
- `CONCAT('Hello', NULL)` ‚Üí `NULL` (–≤ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–µ –°–£–ë–î)
- `CONCAT_WS(',', 'a', NULL, 'b')` ‚Üí `'a,b'` (–ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç NULL)

---

## üí° –ö–∞–∫ —ç—Ç–æ –∑–∞–ø–æ–º–Ω–∏—Ç—å

### –®–ø–∞—Ä–≥–∞–ª–∫–∞ –ø–æ –≤—ã–±–æ—Ä—É:
| –ù—É–∂–Ω–æ... | –ò—Å–ø–æ–ª—å–∑—É–π |
| -------- | --------- |
| –ü—Ä–æ—Å—Ç–æ–µ "–µ—Å–ª–∏-—Ç–æ" | `IF()` (MySQL) –∏–ª–∏ –ø—Ä–æ—Å—Ç–æ–π `CASE` |
| –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —É—Å–ª–æ–≤–∏—è | `CASE WHEN ... WHEN ... END` |
| –î–∞—Ç—å –ø–æ–Ω—è—Ç–Ω–æ–µ –∏–º—è | –ê–ª–∏–∞—Å `AS –Ω–æ–≤–æ–µ_–∏–º—è` |
| –û–±—ä–µ–¥–∏–Ω–∏—Ç—å —Å—Ç—Ä–æ–∫–∏ | `CONCAT()` –∏–ª–∏ `\|\|` |
| –û–±—Ä–∞–±–æ—Ç–∞—Ç—å —Ç–µ–∫—Å—Ç | –°—Ç—Ä–æ–∫–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ |

### –ß–∞—Å—Ç—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã:
```sql
-- –°—Ç–∞—Ç—É—Å –Ω–∞ —Ä—É—Å—Å–∫–æ–º
CASE status 
    WHEN 1 THEN '–ê–∫—Ç–∏–≤–µ–Ω' 
    WHEN 0 THEN '–ù–µ–∞–∫—Ç–∏–≤–µ–Ω' 
    ELSE '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ' 
END AS —Å—Ç–∞—Ç—É—Å

-- –ü–æ–ª–Ω–æ–µ –∏–º—è
CONCAT(last_name, ', ', first_name) AS –ø–æ–ª–Ω–æ–µ_–∏–º—è

-- –ö–∞—Ç–µ–≥–æ—Ä–∏—è –ø–æ —Å—É–º–º–µ
CASE 
    WHEN total > 1000 THEN 'VIP'
    WHEN total > 500 THEN '–ü–æ—Å—Ç–æ—è–Ω–Ω—ã–π'
    ELSE '–û–±—ã—á–Ω—ã–π'
END AS –∫–∞—Ç–µ–≥–æ—Ä–∏—è_–∫–ª–∏–µ–Ω—Ç–∞
```

### –ó–æ–ª–æ—Ç—ã–µ –ø—Ä–∞–≤–∏–ª–∞:
1. **–í—Å–µ–≥–¥–∞ –¥–∞–≤–∞–π –∞–ª–∏–∞—Å—ã** —Å–ª–æ–∂–Ω—ã–º –≤—ã—Ä–∞–∂–µ–Ω–∏—è–º
2. **CASE –≤—Å–µ–≥–¥–∞ –∑–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è END**
3. **–ü—Ä–æ–≤–µ—Ä—è–π NULL** –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å–æ —Å—Ç—Ä–æ–∫–∞–º–∏
4. **–ö–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏—è + NULL = NULL** (–æ—Å—Ç–æ—Ä–æ–∂–Ω–æ!)
5. **–ê–ª–∏–∞—Å—ã —Ç–∞–±–ª–∏—Ü** –¥–µ–ª–∞—é—Ç JOIN —á–∏—Ç–∞–µ–º–µ–µ
